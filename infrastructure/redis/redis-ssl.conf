# Redis SSL/TLS Configuration
# Enable TLS for encrypted Redis connections
#
# Append this to redis.conf or use: redis-server /path/to/redis.conf --include redis-ssl.conf

# TLS Port (default 6379 is non-TLS)
port 0
tls-port 6380

# TLS Certificate Files
# Generate with: openssl req -x509 -newkey rsa:4096 -keyout redis.key -out redis.crt -days 365 -nodes
tls-cert-file /etc/redis/certs/redis.crt
tls-key-file /etc/redis/certs/redis.key

# Optional: CA certificate for client verification
# tls-ca-cert-file /etc/redis/certs/ca.crt

# Client Certificate Verification
# no: Don't require client certificates
# optional: Accept both authenticated and non-authenticated clients
# yes: Require client certificates
tls-auth-clients no

# TLS Protocols
tls-protocols "TLSv1.2 TLSv1.3"

# TLS Ciphers (Strong ciphers only)
tls-ciphers DEFAULT:!MEDIUM:!LOW:!aNULL:!eNULL:!EXPORT:!DES:!RC4:!MD5:!PSK

# TLS Cipher Suites for TLS 1.3
tls-ciphersuites TLS_CHACHA20_POLY1305_SHA256:TLS_AES_256_GCM_SHA384:TLS_AES_128_GCM_SHA256

# Prefer server ciphers
tls-prefer-server-ciphers yes

# Session Caching
tls-session-caching yes
tls-session-cache-size 20480
tls-session-cache-timeout 300

# Authentication (in addition to TLS)
# CRITICAL: Set a strong password
requirepass changeme_use_strong_password_here

# Rename dangerous commands
rename-command FLUSHDB ""
rename-command FLUSHALL ""
rename-command KEYS ""
rename-command CONFIG ""

# ACL (Redis 6.0+)
# Recommended: Use ACL instead of requirepass
# aclfile /etc/redis/users.acl
